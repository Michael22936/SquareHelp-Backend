<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Message</title>
    <th:block th:replace="partials/head :: main-header"/>
    <th:block th:replace="partials/navbar :: main-navbar"/>
</head>
<body>


<!--    ============= Modal Start======================-->
<!--  // Checks if users list is NULL-->
<th:block th:if="${ListOfUsers != null}">
    <!-- Modal -->
    <div class="modal fade" id="exampleModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel2">Pick A User To View Profile</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <table class="table table-hover modal-body table-condensed">
                    <thead>
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Username</th>
                        <th scope="col">Email</th>
                    </tr>
                    </thead>
                    <tbody th:each="user, iterStat : ${ListOfUsers}">

                    <tr class="clickable userRow" th:onclick="|window.location.href='/search/{user.id}/message'|">
                        <!--              <button th:href="@{'/profile/' + ${user.id} }" class="">-->

                        <th scope="row" th:text="${iterStat.count}"></th>
                        <td th:text="${user.username}"></td>
                        <td th:text="${user.email}"></td>
                        <!--                </button>-->
                    </tr>

                    </tbody>
                </table>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <!--            <button type="button" class="btn btn-primary">Save changes</button>-->
                </div>
            </div>
        </div>
    </div>
    <!--    // Modal End-->
    <script>
        setTimeout(function() {
            $('#exampleModal2').modal();
            console.log("Modal fired!")
        }, 500);
    </script>
</th:block>

<form th:action="@{'/search/' + ${users.id} + '/message'}" method="post">
<h1>Who do you want to send the message to: </h1>
        <input type="text"  name="recipientUser">
    <button id="searchBtn" class="btn btn-outline-secondary" data-toggle="modal" data-target="#exampleModal2" type="submit">Search</button>
</form>
<form th:action="'/send/' + ${messages.author_user_id} + '/message'" method="post" th:object="${messages}">


<h1>What message do you want to send: </h1>

        <textarea th:field="*{message}" name="message" id="message" cols="30" rows="10"></textarea>

    <br>

    <button type="submit">Send Message</button>

</form>

<div th:each="user, iterStat : ${ListOfUsers}">
    <p scope="row" th:text="${iterStat.count}"></p>
    <p th:text="${user.username}"></p>
    <p th:text="${user.email}"></p>
</div>

<th:block th:replace="partials/footer :: main-footer"/>
</body>
</html>